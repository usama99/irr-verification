<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IRR AS Link Validation Research</title>

    <!-- Pako.js for gzip decompression -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .header {
            background: white;
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
        }
        h1 { color: #333; font-size: 32px; margin-bottom: 10px; }
        .subtitle { color: #666; font-size: 16px; margin-bottom: 30px; line-height: 1.6; }
        .search-section {
            background: white;
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .search-label {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: block;
        }
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        input[type="text"] {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 18px;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        button {
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        button:hover { transform: translateY(-2px); }
        .example { font-size: 14px; color: #666; margin-top: 10px; }
        .result-box {
            margin-top: 30px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            display: none;
        }
        .result-box.show { display: block; }
        .as-number {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .as-name {
            font-size: 20px;
            color: #555;
            margin-bottom: 5px;
        }
        .as-org {
            font-size: 16px;
            color: #666;
            margin-bottom: 5px;
        }
        .as-country {
            font-size: 16px;
            color: #666;
            margin-bottom: 15px;
        }
        .as-stats {
            font-size: 18px;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 20px;
        }
        .contact-btn {
            padding: 15px 40px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        .contact-btn:hover { transform: translateY(-2px); }
        .error-box {
            margin-top: 30px;
            padding: 20px;
            background: #fff3cd;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            color: #856404;
            display: none;
        }
        .error-box.show { display: block; }
        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-size: 16px;
            display: none;
        }
        .loading.show { display: block; }
        .info-section {
            background: white;
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .info-section h2 {
            color: #333;
            font-size: 24px;
            margin-bottom: 15px;
        }
        .info-section p {
            color: #666;
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 15px;
        }
        .footer {
            text-align: center;
            padding: 20px;
            color: white;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <h1>üåê IRR AS Link Validation</h1>
            <p class="subtitle">
                Help us to validate IRR peering data accuracy.<br>
<!--                Search your AS to view IRR links and help us validate them.-->
            </p>
        </div>

        <!-- SEARCH SECTION -->
        <div class="search-section">
            <label class="search-label">üîç Search Your Autonomous System (AS)</label>
            <div class="search-box">
                <input type="text" id="asnInput" placeholder="Enter AS Number (e.g., 7713 or AS7713)" onkeypress="if(event.key==='Enter') searchAS()">
                <button onclick="searchAS()">Search</button>
            </div>
            <p class="example">Example: AS7713 (Telkom Indonesia), AS3356 (Level 3), AS15169 (Google)</p>

            <!-- LOADING -->
            <div id="loading" class="loading">Searching...</div>

            <!-- ERROR MESSAGE -->
            <div id="errorBox" class="error-box">
                <strong>AS Not Found</strong><br>
                The AS number you entered was not found in our dataset. Please verify the AS number and try again.
            </div>

            <!-- RESULT -->
            <div id="resultBox" class="result-box">
                <div class="as-number" id="asNumber"></div>
                <div class="as-name" id="asName"></div>
                <div class="as-org" id="asOrg"></div>
                <div class="as-country" id="asCountry"></div>
                <div class="as-stats" id="asStats"></div>
                <a href="#" id="contactBtn" class="contact-btn">üìß Contact Us to Validate Your IRR Links</a>
            </div>
        </div>

        <!-- INFO SECTION -->
        <div class="info-section">
            <h2>üìã About This Research</h2>
            <p>
                Our research published at IEEE INFOCOM 2025: "Exploring the Internet Routing Registries To Augment AS-level Topology.
            </p>
            <p>
                <strong>Key Finding:</strong> 3.1M AS links extracted from IRR, 1.6M not visible in BGP/Traceroute/IXP. These may be active peering or outdated entries. Operator validation needed.
            </p>

            <h2>‚ùì How to Participate</h2>
            <p>
                1. <strong>Search</strong> for your AS number above<br>
                2. <strong>Review</strong> the statistics showing how many IRR links we found for your AS<br>
                3. <strong>Contact us</strong> to validate your links<br>
                4. <strong>Validate</strong> your peer links (takes 5-10 minutes)
            </p>

            <h2>‚úâÔ∏è Contact</h2>
            <p>
                <strong>Email:</strong> usamaijaz404@gmail.com<br>
                <strong>Lab:</strong> Network Data Science Lab, Sangmyung University<br>
                <strong>Researcher:</strong> Usama Ejaz (PhD Student)
            </p>
        </div>

        <div class="footer">
            ¬© 2025 Network Data Science Lab, Sangmyung University
        </div>
    </div>

    <script>
        // Large compressed files
        const COMPRESSED_FILES = ['russia.json', 'germany.json', 'united_states.json', 'united_kingdom.json', 'brazil.json', 'poland.json', 'ukraine.json'];

        let countryIndex = {};

        // Load country index on page load
        async function initialize() {
            try {
                const response = await fetch('data/country_index.json');
                countryIndex = await response.json();
                console.log('‚úì Country index loaded');
            } catch (error) {
                console.error('Error loading country index:', error);
            }
        }

        initialize();

        // Load country file (handles compressed files)
        async function loadCountryFile(filename) {
            const isCompressed = COMPRESSED_FILES.includes(filename);

            if (isCompressed) {
                const gzFile = `data/${filename}.gz`;
                const response = await fetch(gzFile);
                const arrayBuffer = await response.arrayBuffer();
                const decompressed = pako.ungzip(new Uint8Array(arrayBuffer), { to: 'string' });
                return JSON.parse(decompressed);
            } else {
                const response = await fetch(`data/${filename}`);
                return await response.json();
            }
        }

        // Search AS
        async function searchAS() {
            const asnInput = document.getElementById('asnInput').value.trim().replace(/^AS/i, '');

            if (!asnInput) {
                return;
            }

            // Hide previous results
            document.getElementById('resultBox').classList.remove('show');
            document.getElementById('errorBox').classList.remove('show');
            document.getElementById('loading').classList.add('show');

            try {
                // Check if AS exists in index
                if (!countryIndex[asnInput]) {
                    throw new Error('AS not found');
                }

                const asInfo = countryIndex[asnInput];
                const countryFile = asInfo.filename;
                const countryName = asInfo.country;

                // Load country data
                const countryData = await loadCountryFile(countryFile);

                if (!countryData[asnInput]) {
                    throw new Error('AS data not found');
                }

                const asData = countryData[asnInput];
                const asInfoDetail = asData.as_info || {};
                const linkCount = asData.links ? asData.links.length : 0;

                // Display result
                document.getElementById('asNumber').textContent = `AS${asnInput}`;
                document.getElementById('asName').textContent = asInfoDetail.name || 'Unknown';
                document.getElementById('asOrg').textContent = asInfoDetail.org || 'Unknown Organization';
                document.getElementById('asCountry').textContent = `üìç ${countryName}`;
                document.getElementById('asStats').textContent = `üìä Total IRR Links: ${linkCount.toLocaleString()}`;

                // Setup contact button
                const contactBtn = document.getElementById('contactBtn');
                const emailSubject = encodeURIComponent(`IRR Link Validation Request - AS${asnInput}`);
                const emailBody = encodeURIComponent(
                    `Hello,\n\n` +
                    `I would like to request access to validate IRR links for:\n\n` +
                    `AS Number: ${asnInput}\n` +
                    `AS Name: ${asInfoDetail.name || 'Unknown'}\n` +
                    `Organization: ${asInfoDetail.org || 'Unknown'}\n` +
                    `Country: ${countryName}\n` +
                    `Total IRR Links: ${linkCount}\n\n` +
                    `Please provide validation portal access.\n\n` +
                    `Thank you.`
                );
                contactBtn.href = `mailto:usamaijaz404@gmail.com?subject=${emailSubject}&body=${emailBody}`;

                document.getElementById('resultBox').classList.add('show');
                document.getElementById('loading').classList.remove('show');

            } catch (error) {
                console.error('Search error:', error);
                document.getElementById('errorBox').classList.add('show');
                document.getElementById('loading').classList.remove('show');
            }
        }
    </script>
</body>
</html>